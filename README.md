# Word文档英译中翻译器

一个基于Python的Word文档英译中翻译工具，使用图形界面，支持保留原文档格式并在原文后插入中文翻译。

## 功能特点

- 📄 **Word文档翻译**：支持 `.docx` 格式文档的英译中翻译
- 🔄 **并发翻译**：使用多线程并发处理，提高翻译速度（默认15线程）
- 🔁 **智能重试**：内置重试机制（最多5次），采用指数退避策略
- 🎨 **保留格式**：完整保留原文档的所有元素（图表、表格等）
- 📝 **双语对照**：在每段英文后插入对应的中文翻译
- 💻 **图形界面**：简洁易用的Tkinter GUI界面
- 📊 **实时进度**：显示翻译进度和实时预览

## 环境要求

- Python 3.6+
- 依赖库：
  - `python-docx` - Word文档处理
  - `googletrans==4.0.0rc1` - Google翻译API
  - `tkinter` - 图形界面（Python自带）

## 安装步骤

1. 克隆项目到本地：
```bash
git clone https://github.com/ToGoRun/En_To_Ch_Charge.git
cd En_To_Ch_Charge
```

2. 创建虚拟环境（推荐）：
```bash
python -m venv venv
# Windows
venv\Scripts\activate
# macOS/Linux
source venv/bin/activate
```

3. 安装依赖：
```bash
pip install python-docx googletrans==4.0.0rc1
```

## 使用方法

1. 运行程序：
```bash
python En_To_Ch_Charge.py
```

2. 操作步骤：
   - 点击 **"选择Word文档"** 按钮，选择要翻译的英文Word文档
   - 点击 **"开始翻译"** 按钮，程序将自动翻译文档
   - 翻译过程中可以在界面中查看实时进度和预览
   - 翻译完成后，点击 **"导出文档"** 按钮保存翻译后的文档

## 工作原理

1. **读取文档**：使用 `python-docx` 读取原始Word文档
2. **提取段落**：提取所有非空段落文本
3. **并发翻译**：使用线程池并发调用Google翻译API进行翻译
4. **保留格式**：在原段落后直接插入翻译文本，保留所有原始元素
5. **导出文档**：保存为新的Word文档，包含英中双语对照内容

## 配置参数

可在代码中调整以下参数（`__init__` 方法）：

```python
self.max_workers = 15      # 并发线程数（根据网络情况调整）
self.max_retries = 5       # 最大重试次数
self.retry_delay = 1       # 重试延迟基数（秒）
```

## 注意事项

- ⚠️ 需要网络连接才能使用Google翻译服务
- ⚠️ 翻译速度取决于网络状况和文档大小
- ⚠️ 建议翻译前备份原文档
- ⚠️ 大文档翻译可能需要较长时间，请耐心等待

## 输出格式

翻译后的文档将保持以下格式：
```
[原始英文段落]
[对应的中文翻译]
[原始英文段落]
[对应的中文翻译]
...
```

## 故障排除

### 翻译失败
- 检查网络连接
- 尝试减少并发线程数（`max_workers`）
- 增加重试次数（`max_retries`）

### 文档格式问题
- 确保输入文件为 `.docx` 格式
- 检查文档是否损坏

### 程序崩溃
- 检查Python版本是否符合要求
- 确认所有依赖包已正确安装

## 许可证

本项目使用 MIT 许可证

## 贡献

欢迎提交Issue和Pull Request！

## 作者

ToGoRun

## 更新日志

### v1.0.0 (2025-10-08)
- 初始版本发布
- 支持Word文档英译中翻译
- 并发处理和智能重试机制
- 图形界面实现
